<?xml version="1.0" encoding="UTF-8"?>
<DatasourceManager xmlVersion="20120529" releaseVersion="7.0.0">
<ConnectionMap>
<Connection name="FRDemo" class="com.fr.data.impl.JDBCDatabaseConnection">
<DatabaseAttr/>
<JDBCDatabaseAttr url="jdbc:mysql://localhost:3306/office?useUnicode=true&amp;characterEncoding=UTF-8" driver="com.mysql.jdbc.Driver" user="root" password="___006100210065007b" encryptPassword="true">
<DBCPAttr/>
</JDBCDatabaseAttr>
</Connection>
</ConnectionMap>
<TableDataMap>
<TableData name="searchPaymentVoucher " class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * FROM t_paymentvoucher a
where a.applicantId='${userId}']]></Query>
</TableData>
<TableData name="searchPaymentVoucherItem" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * FROM t_paymentvoucheritem a
WHERE paymentVoucherId='${userId}']]></Query>
</TableData>
<TableData name="selectMajor" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='z' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectEnglish" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='e' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="userScore" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="quesId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="displayName"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id AS aid,a.quesId,a.score,a.userId,b.title ,c.displayName,b.modifyDate
FROM userQuestionnaire a
LEFT JOIN questionnaire AS b ON b.id=a.quesId
INNER JOIN user AS c ON a.userId=c.id
WHERE c.displayName like "%${displayName}%"
AND a.quesId='${quesId}']]></Query>
</TableData>
<TableData name="questionScore" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="quesId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="displayName"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.quesId, a.questionId, a.result, b.content, b.number ,c.displayName, d.number AS selecterNo,d.content AS selecterContent,a.addDate
FROM userQuestion AS a
LEFT JOIN question AS b ON a.questionId=b.id
LEFT JOIN selecter as d ON b.id=d.questionId
INNER JOIN user AS c ON a.userId=c.id
WHERE c.displayName = "${displayName}"
AND d.answer = 'y'
AND a.quesId='${quesId}']]></Query>
</TableData>
<TableData name="addDivision" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id,a.name FROM division a]]></Query>
</TableData>
<TableData name="addPosition" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id,a.name FROM t_position a
]]></Query>
</TableData>
<TableData name="addReg" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="loginName"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
		SELECT 
			a.id, 
			a.userId, 
			a.staffCode, 
			a.firstName, 
			a.middleNameEn, 
			a.lastName, 
			a.loginName, 
			a.password, 
			a.displayName, 
			a.workGroupName, 
			a.workGroupDetailName, 
			a.attachPersonalPhoto, 
			a.dateTime, 
			a.status, 
			a.email, 
			a.language, 
			a.englishProficiency, 
			(SELECT userInfor.`name` FROM userInfor WHERE a.englishProficiency != '' AND userInfor.`code` = a.englishProficiency LIMIT 1) AS englishProficiencyName,
			a.chineseName, 
			a.englishName, 
			a.departmentId, 
			a.targetPosition, 
			a.positionId, 
			(SELECT userInfor.`name` FROM userInfor WHERE a.positionId != '' AND userInfor.`code` = a.positionId LIMIT 1) AS positionName,
			a.rank, 
			a.gender, 

			CASE WHEN 
				a.gender = 'f'
			THEN 
				'Female'
			ELSE
				'Male'
			END AS genderName,
			a.birthDate, 
			a.ethnicGroup, 

			CASE WHEN
				a.ethnicGroup != 'm1'
			THEN
				'其它'
			ELSE
				'汉族'
			END  AS ethnicGroupName,
			a.nationality, 
			a.maritalStatus, 
			a.politicalIdentity, 
			a.religion, 
			a.idNo, 
			a.idNoType, 
			a.idNoAccess, 
			a.attachIdNo, 
			a.officialTelNo, 
			a.VNetNo, 
			a.email, 
			a.entryDate, 
			a.departedDate, 
			a.seniority, 
			a.contractor, 
			a.contractNo, 
			a.contractPeriod, 
			a.turns, 
			a.initialDate, 
			a.resgisteredResidence, 
			a.phoneNo, 
			a.telephoneNo, 
			a.addressAvailable, 
			a.socialSecurityPermission, 
			a.socialSecurityPayingStatus, 
			a.socialSecurityNo, 
			a.houseFundingPayingStatus, 
			a.houseFundingPermission, 
			a.houseFundingNo, 
			a.bankCard, 
			a.emergencyName1, 
			a.emergencyRelationship1, 
			a.emergencyCompanyAndTitle1, 
			a.emergencyPhoneNo1, 
			a.emergencyName2, 
			a.emergencyRelationship2, 
			a.emergencyCompanyAndTitle2, 
			a.emergencyPhoneNo2, 
			a.emergencyName3, 
			a.emergencyRelationship3, 
			a.emergencyCompanyAndTitle3, 
			a.emergencyPhoneNo3, 
			a.indexEmergency, 
			a.beginEducationalPeriod1, 
			a.endEducationalPeriod1, 
			a.schoolName1, 
			a.major1, 
			(SELECT userInfor.`name` FROM userInfor WHERE a.major1 != '' AND userInfor.`code` = a.major1 LIMIT 1) AS major1Name,
			a.educationalDegree1, 
			(SELECT userInfor.`name` FROM userInfor WHERE a.educationalDegree1 != '' AND userInfor.`code` = a.educationalDegree1 LIMIT 1) AS educationalDegree1Name,
			a.educationalStatus1, 
			a.attachEducationalDegree1, 
			a.attachDegree1, 
			a.proveEducationalDegree1, 
			a.proveDegree1, 
			a.beginEducationalPeriod2, 
			a.endEducationalPeriod2, 
			a.schoolName2, 
			a.major2, 
			a.educationalDegree2, 
			a.educationalStatus2, 
			a.attachEducationalDegree2, 
			a.attachDegree2, 
			a.proveEducationalDegree2, 
			a.proveDegree2, 
			a.beginEducationalPeriod3, 
			a.endEducationalPeriod3, 
			a.schoolName3, 
			a.major3, 
			a.educationalDegree3, 
			a.educationalStatus3, 
			a.attachEducationalDegree3, 
			a.attachDegree3, 
			a.proveEducationalDegree3, 
			a.proveDegree3, 
			a.indexEducation, 
			a.skills1, 
			a.certificatesOrLicenses1, 
			a.skillsProve1, 
			a.certificatedDate1, 
			a.skills2, 
			a.certificatesOrLicenses2, 
			a.skillsProve2, 
			a.certificatedDate2, 
			a.skills3, 
			a.certificatesOrLicenses3, 
			a.skillsProve3, 
			a.certificatedDate3, 
			a.indexSkill, 
			a.degreeCertificateDetails, 
			a.degreeCertificateValidity, 
			a.diplomaCertificateDetails, 
			a.diplomaCertificateValidity, 
			a.englishCertificateDetails, 
			a.englishCertificateValidity, 
			a.careerLicenseDetails, 
			a.careerLicenseValidity, 
			a.IDNODetails, 
			a.IDNOValidity, 
			a.PETDetails, 
			a.PETValidity, 
			a.othersDetails, 
			a.othersValidity, 
			a.picUri, 
			a.approverId, 
			a.approverName, 
			a.approverTime, 
			a.approveStatus, 
			a.answerStatus, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp, 
			a.careerFrom1, 
			a.careerEnd1, 
			a.careerCompany1, 
			a.industry1, 
			a.careerPosition1, 
			a.careerlr1, 
			a.careerRequired1, 
			a.careerSalary1, 
			a.careerSocial1, 
			a.careerhouse1, 
			a.careerFrom2, 
			a.careerEnd2, 
			a.careerCompany2, 
			a.industry2, 
			a.careerPosition2, 
			a.careerlr2, 
			a.careerRequired2, 
			a.careerSalary2, 
			a.careerSocial2, 
			a.careerhouse2, 
			a.careerFrom3, 
			a.careerEnd3, 
			a.careerCompany3, 
			a.industry3, 
			a.careerPosition3, 
			a.careerlr3, 
			a.careerRequired3, 
			a.careerSalary3, 
			a.careerSocial3, 
			a.careerhouse3, 
			a.indexCareer, 
			a.oiAccept, 
			a.oiAgreement, 
			a.oiTermination, 
			a.province, 
			a.city, 
			a.district,
			b.*
		FROM userDetail AS a
	LEFT JOIN `user` AS b ON b.id = a.userId



where a.loginName='${loginName}']]></Query>
</TableData>
<TableData name="itemsRule" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.type, a.specification, a.unit, a.id,a.price
FROM itemRule AS a ]]></Query>
</TableData>
<TableData name="searchUser" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="approve"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.userId, a.id,a.department,a.applyMonth,a.leaderName
FROM office AS a 
where a.departmentId = '${departmentId}' 
AND a.approveState = '${approve}'
AND a.applyMonth = '${applyMonth}'
AND a.flag = 'p'
GROUP BY a.userId]]></Query>
</TableData>
<TableData name="searchUserOld" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depOfficeId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.userId, a.id,a.department,a.applyMonth,a.leaderName
FROM office AS a
where a.departmentId = '${departmentId}'
AND a.applyMonth = '${applyMonth}'
AND a.depOfficeId= "${depOfficeId}"
GROUP BY a.userId]]></Query>
</TableData>
<TableData name="searchAmount" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.type,a.unit,a.specification,SUM(a.amount), b.id as rid, c.userId, c.userName, c.applyMonth, d.id as did
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
LEFT JOIN depOffice AS d ON c.depOfficeId = d.id
where  c.applyMonth='${applyMonth}'
AND c.approveState="approve2"
AND c.departmentId='${departmentId}'
GROUP BY rid, c.userId
]]></Query>
</TableData>
<TableData name="searchAmountOld" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depOfficeId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.type,a.unit,a.specification,SUM(a.amount), b.id as rid, c.userId, c.userName ,d.id
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
LEFT JOIN depOffice AS d ON c.depOfficeId = d.id
WHERE d.id = '${depOfficeId}'
GROUP BY rid, c.userId
]]></Query>
</TableData>
<TableData name="searchOffice" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * FROM office AS a 
LEFT JOIN item AS b on 
b.officeId =a.id
]]></Query>
</TableData>
<TableData name="searchOfficeYear" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT  a.department, a.applyMonth, a.departmentId, d.id AS ruleId, b.id AS officeId, c.id, SUM(c.amount) AS amount, c.id AS itemId, c.specification, c.type, c.unit, d.price, 
b.modifiedDate
FROM depOffice AS a
LEFT JOIN office AS b ON b.depOfficeId = a.id
LEFT JOIN item AS c ON c.officeId = b.id
INNER JOIN itemRule AS d ON d.id = c.ruleId
where b.approveState="approve2"
and a.departmentId="${departmentId}"
and a.applyMonth="${applyMonth}"
GROUP BY  a.applyMonth, c.ruleId]]></Query>
</TableData>
<TableData name="searchDepOffice" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT distinct a.*, b.approve2Date
FROM depOffice AS a
INNER JOIN office AS b ON a.id= b.depOfficeId 
where a.approveState="approve2"
GROUP BY a.applyMonth, a.department
ORDER BY a.applyMonth ]]></Query>
</TableData>
<TableData name="searchOfficeItem" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT b.department, b.departmentId, b.id AS officeId, b.applyMonth, b.approveState, 
c.id, SUM(c.amount) AS amount, c.id AS itemId, c.specification, c.type, c.unit, 
d.id AS ruleId, d.price 
FROM office AS b
LEFT JOIN item AS c ON c.officeId = b.id
INNER JOIN itemRule AS d ON d.id = c.ruleId
GROUP BY d.id
]]></Query>
</TableData>
<TableData name="searchItemAll" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id, a.type, a.ruleId, b.department, b.departmentId, b.applyMonth, b.depOfficeId
FROM item AS a
INNER JOIN office AS b ON b.id = a.officeId]]></Query>
</TableData>
<TableData name="searchTotal" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.departmentId, sum(b.amount * c.price)AS totalAmount,d.approveState, a.applyMonth
FROM office AS a
INNER JOIN item AS b ON b.officeId = a.id
INNER JOIN itemRule AS c ON c.id = b.ruleId
LEFT JOIN depOffice AS d ON a.depOfficeId=d.id
WHERE a.approveState="approve2"
GROUP BY   a.applyMonth,a.departmentId 

]]></Query>
</TableData>
<TableData name="searchItem" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT c.id as rid, a.id as id, a.type, a.specification, a.unit, c.price ,b.applyMonth
FROM item AS a
INNER JOIN office AS b ON a.officeId = b.id
INNER JOIN itemRule AS c ON c.id =a.ruleId
WHERE b.departmentId = '${departmentId}' 
AND b.applyMonth = '${applyMonth}'
and b.approveState="approve2"
GROUP BY rid]]></Query>
</TableData>
<TableData name="searchItemOld" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depOfficeId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT c.id as rid, a.id as id, a.type, a.specification, a.unit, c.price ,b.applyMonth,b.approve1Date
FROM item AS a
INNER JOIN office AS b ON a.officeId = b.id
INNER JOIN itemRule AS c ON c.id =a.ruleId
WHERE b.departmentId = '${departmentId}' 
AND b.applyMonth = '${applyMonth}'
and b.approveState="approve2"
and b.depOfficeId="${depOfficeId}"
GROUP BY rid]]></Query>
</TableData>
<TableData name="searchDepCount" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT  COUNT(DISTINCT a.userId) as conutUser, a.department,a.departmentId, a.applyMonth
FROM office AS a
WHERE a.approveState="approve2"
AND a.flag = 'p'
GROUP BY a.applyMonth, a.department]]></Query>
</TableData>
<TableData name="searchEmpByParam" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.department, a.applyMonth, sum(b.amount * c.price)AS totalAmount 
FROM office AS a
INNER JOIN item AS b ON b.officeId = a.id
INNER JOIN itemRule AS c ON c.id = b.ruleId
WHERE a.approveState="approve2"
AND a.departmentId = '${departmentId}' 
AND a.applyMonth = '${applyMonth}'
GROUP BY a.userName,a.applyMonth
ORDER BY a.userName, a.applyMonth]]></Query>
</TableData>
<TableData name="searchEmpByDep" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userName"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.departmentId, a.userId, a.userName, a.department, a.applyMonth, sum(b.amount * c.price)AS totalAmount 
FROM office AS a
INNER JOIN item AS b ON b.officeId = a.id
INNER JOIN itemRule AS c ON c.id = b.ruleId
WHERE a.approveState="approve2"
and a.userName like'%${userName}%'
GROUP BY a.userName,a.departmentId,a.applyMonth]]></Query>
</TableData>
<TableData name="paramDep" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT  DISTINCT (a.department) as disDip, a.departmentId
FROM office AS a
WHERE a.approveState="approve2"
GROUP BY a.userName,a.applyMonth
ORDER BY disDip]]></Query>
</TableData>
<TableData name="searchPerson" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userId, a.userName, a.department, a.applyMonth, a.departmentId, c.id AS ruleId, a.id AS officeId, b.id, SUM(b.amount) AS amount, b.id AS itemId, b.specification, b.type, b.unit, c.price  
FROM office AS a
LEFT JOIN item AS b ON b.officeId = a.id
INNER JOIN itemRule AS c ON c.id = b.ruleId
WHERE a.approveState="approve2"
AND a.userId="${userId}"
AND a.applyMonth>="${startDate}"
AND a.applyMonth<="${endDate}"

GROUP BY a.applyMonth,  b.ruleId]]></Query>
</TableData>
<TableData name="searchPersonBydepId" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userId, a.userName, a.department, a.applyMonth, a.departmentId, c.id AS ruleId, a.id AS officeId, b.id, SUM(b.amount) AS amount, b.id AS itemId, b.specification, b.type, b.unit, c.price  
FROM office AS a
LEFT JOIN item AS b ON b.officeId = a.id
INNER JOIN itemRule AS c ON c.id = b.ruleId
WHERE a.approveState="approve2"
AND a.userId="${userId}"
AND a.applyMonth>="${startDate}"
AND a.applyMonth<="${endDate}"
AND a.departmentId="${departmentId}"
GROUP BY a.applyMonth,  b.ruleId]]></Query>
</TableData>
<TableData name="searchEmpUser" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.userId, a.id,a.department,a.applyMonth,a.leaderName
FROM office AS a
LEFT JOIN office AS b ON a.pid =b.id
 where a.departmentId = '${departmentId}' and b.id = ${bid}
AND
(a.approveState = 'approve1'
OR
a.approveState = 'approve2'
)

]]></Query>
</TableData>
<TableData name="searchEmpAmount" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.*,b.id as rid
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId  
LEFT JOIN office AS d ON c.pid =d.id
where c.departmentId = '${departmentId}' AND d.id = ${bid} 
AND
(c.approveState = 'approve1'
OR
c.approveState = 'approve2')]]></Query>
</TableData>
<TableData name="itemAmount" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT  a.id, a.type, a.specification, a.unit, d.modifiedDate, SUM(a.amount),b.price, d.flag, d.pid
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
LEFT JOIN depOffice AS d ON c.depOfficeId = d.id
WHERE d.pid =
(SELECT MAX(pid) AS mpid  FROM depOffice e
GROUP BY e.pid DESC
LIMIT 1)
group by a.type,a.specification,a.unit]]></Query>
</TableData>
<TableData name="itemAmountOld" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT  a.id, a.type, a.specification, a.unit, d.modifiedDate, SUM(a.amount),b.price, d.flag, d.pid
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
LEFT JOIN depOffice AS d ON c.depOfficeId = d.id
WHERE d.pid = ${depId}
group by a.type,a.specification,a.unit]]></Query>
</TableData>
<TableData name="searchUserDep" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.userId, a.id,a.department,a.departmentId
FROM office AS a
where a.approveState = 'approve1' and a.flag = 'p' 
ORDER BY a.department]]></Query>
</TableData>
<TableData name="searchAmountDep" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.*,b.id as rid
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId  where c.approveState= 'approve1' and c.flag = 'p']]></Query>
</TableData>
<TableData name="searchUserDepF" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT c.userName, c.userId, c.id,c.department,a.applyMonth,c.departmentId
FROM depOffice as a 
LEFT JOIN depOffice as b ON a.pid = b.id
LEFT JOIN office as c ON a.id = c.depOfficeId
WHERE b.id =${depId}
AND
c.approveState = 'approve2']]></Query>
</TableData>
<TableData name="searchAmountDepF" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="depId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.*,b.id as rid
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
LEFT JOIN depOffice AS d ON c.depOfficeId = d.id
WHERE d.pid =${depId}
AND
c.approveState = 'approve2']]></Query>
</TableData>
<TableData name="searchUserEmp" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="approve"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.userName, a.userId, a.id,a.department,a.applyMonth,a.leaderName
FROM office AS a 
where a.departmentId = '${departmentId}' 
AND a.approveState = '${approve}'
]]></Query>
</TableData>
<TableData name="searchAmountEmp" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="approve"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.*,b.id as rid, c.userId, c.userName
FROM item AS a
LEFT JOIN itemRule AS b ON b.id = a.ruleId
LEFT JOIN office AS c ON c.id = a.officeId 
where c.departmentId = '${departmentId}' 
AND c.approveState = '${approve}']]></Query>
</TableData>
<TableData name="selectEthnic" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='m' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectNationality" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='g' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectPolitical" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='zz' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectReligion" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='zj' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectRelationship" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='gx' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectDegree" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.`name`,a.code FROM userInfor a
WHERE a.type='xl' AND a.flag='i' AND a.`status`='a']]></Query>
</TableData>
<TableData name="selectCurrency" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * FROM t_currency]]></Query>
</TableData>
<TableData name="selectCategoryLevel1" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.idLevel=1]]></Query>
</TableData>
<TableData name="selectCategoryLevel2" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.idLevel=2


]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat11"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat11},999)

]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat12"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat12},999)

]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat13"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat13},999)

]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat14"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat14},999)

]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param5" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat15"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat15},999)

]]></Query>
</TableData>
<TableData name="selectCategoryLevel2Param6" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cat16"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from t_category a WHERE a.pid=IFNULL(${cat16},999)

]]></Query>
</TableData>
<TableData name="selectUser" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id,a.displayName FROM user a]]></Query>
</TableData>
<TableData name="selectDivision" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT a.id,a.name FROM division a]]></Query>
</TableData>
<TableData name="searchUserForPv" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * from user]]></Query>
</TableData>
<TableData name="searchNoGen" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT * FROM t_paymentVoucherGen]]></Query>
</TableData>
<TableData name="searchAttendanceAll" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 

-- 			CASE WHEN
-- 				a.dateWeek = '7'
-- 			THEN
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
-- 			ELSE
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
-- 			END workDuration,

			(HOUR(a.timeWork) + MINUTE(a.timeWork)/60 -
				(CASE WHEN
					a.dateWeek = '7'
				THEN
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
				ELSE
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
				END)) trueWrokDuration,

			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			a.late, 
			a.leaveEarly, 
			a.attendHalf, 
			a.absenteeism, 
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp,
	CASE WHEN 
		a.codeVacate = 'WO' OR a.statusAttendance = 'ap2'
	THEN
		'8.00'
	ELSE
		a.workTimeTrue
	END AS workTimeTrue,
			a.workOvertime,
			a.typeVacateDate,
			a.durationAttenVacate,
			CASE WHEN
				a.typeDate = 'w'
			THEN
				'1'
			WHEN
			 	a.typeDate = 'f'
			THEN
				'0'
			END AS typeDateValue,
			a.statusVacate
		FROM attendance AS a
LEFT JOIN permission b ON ( b.parentCode = '1615000' AND b.value1 = a.divisionId)
LEFT JOIN attenrule c ON (c.id = b.value2)
WHERE 
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
-- AND 
--	a.statusVacate = 'a'
ORDER BY a.divisionName, a.userId
]]></Query>
</TableData>
<TableData name="searchAttendanceAll1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="divisions"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			a.late, 
			a.leaveEarly, 
			a.attendHalf, 
			a.absenteeism, 
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp
		FROM attendance AS a
WHERE 
	a.statusAttendance = 're'
AND 
	a.divisionId IN (${divisions})
ORDER BY a.divisionName, a.userId
]]></Query>
</TableData>
<TableData name="searchAttendanceAllCheck1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attendRecordIdAp1"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
   a.id, 
   a.userId, 
   a.userName, 
   a.divisionId, 
   a.divisionName, 
   a.cardNo, 
   a.timeStart, 
   a.timeEnd, 
   a.dayStart, 
   a.dayEnd, 
   a.day, 
   a.dateMonth, 
   a.dateWeek, 
   a.date, 
   a.dateAddMonth, 
   a.timeWork, 
   a.late, 
   a.leaveEarly, 
   a.attendHalf, 
   a.absenteeism, 
   a.statusAttendance, 
   a.statusApprove, 
   a.remark, 
   a.loopYear, 
   a.typeDate, 
   a.festivelName, 
   a.attendRecordIdAp1, 
   a.attendRecordIdAp2, 
   a.addDate, 
   a.addUser, 
   a.addIp, 
   a.modifiedDate, 
   a.modifiedUser, 
   a.modifiedIp
  FROM attendance AS a
WHERE 
	a.attendRecordIdAp1 = '${attendRecordIdAp1}'
ORDER BY a.divisionName, a.userId]]></Query>
</TableData>
<TableData name="searchAttendanceAllCheck2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attendRecordIdAp2"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			a.late,
			a.leaveEarly,
			a.attendHalf,
			a.absenteeism,		
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp
		FROM attendance AS a
WHERE 
	a.attendRecordIdAp2 = '${attendRecordIdAp2}']]></Query>
</TableData>
<TableData name="showAttenVacateApprove" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT 
	a.id, 
	a.name, 
	a.divisionId, 
	a.divisionName, 
	a.userId, 
	a.userName, 
	a.idVacate, 
	a.nameVacate, 
	a.dateStart, 
	a.dateEnd, 
	a.hourStart, 
	a.hourEnd, 
	a.minuteStart, 
	a.minuteEnd, 
	a.typeVacateDate, 
	a.reason, 
	a.duration, 
	a.workday, 
	a.approveId, 
	a.approveName, 
	a.approveDate, 
	a.approveStatus, 
	a.approveId1, 
	a.approveName1, 
	a.approveDate1, 
	a.approveId2, 
	a.approveName2, 
	a.approveDate2, 
	a.remark, 
	a.tag, 
	a.addDate, 
	a.addUser, 
	a.addIp, 
	a.modifiedDate, 
	a.modifiedUser, 
	a.modifiedIp
FROM attenVacateManage AS a
WHERE
	a.typeData = 'v'
AND
	((
	a.dateStart >= '${attenCollectDateStart}'
	AND
	a.dateStart <= '${attenCollectDateEnd}')
	OR
	(a.dateEnd >= '${attenCollectDateStart}'
	AND
	a.dateEnd <= '${attenCollectDateEnd}')
	)
AND
	(
	approveStatus = 'ap1'
	OR
	approveStatus = 'ap2'
	OR
	approveStatus = 'ap3'
	)
ORDER BY a.divisionId,a.userName,a.dateStart
]]></Query>
</TableData>
<TableData name="searchAttendanceFinance" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			b.id,
			a.userId, 
			a.userName, 
		SUM(
				CASE WHEN b.duration > 1
				THEN 1
				ELSE
					b.duration
				END
			) AS attenDuration,
			b.divisionId, 
			b.divisionName, 
			b.duration,
			a.cardNo, 
			a.statusVacate,
			a.idVacate,
			b.`name`,
			c.`code`,
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork,
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp
		FROM attendance AS a
LEFT JOIN attenVacateManage AS b ON b.id = a.idVacateManage
LEFT JOIN attenVacate AS c ON c.id = b.idVacate
WHERE 
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusVacate = 'v'
AND
	c.code != 'WO'
AND
	(a.typeDate = 'w')	
GROUP BY b.id
ORDER BY a.divisionName]]></Query>
</TableData>
<TableData name="showUserList" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[

		SELECT  
			a.status,
			a.userId, 
			a.staffCode, 
			a.firstName, 
			a.lastName, 
			a.displayName,
			a.englishName, 
			a.positionId, 
			a.immediateSuperiorName,
			a.primaryDepartment,
			a.divisionName,
			a.workGroupName,
			a.workGroupDetailName,
			a.rank, 
			a.entryDate,
			a.seniority,
			a.birthDate,
			a.age,
			a.gender, 

			a.ethnicGroup, 

			a.educationalDegree1, 

			a.schoolName1,
			a.major1, 
			a.englishProficiency, 
			a.skills1,
			a.resgisteredResidence,
			a.officialTelNo,
			a.phoneNo,
			a.VNetNo, 
			a.email,
			a.employer,
			a.contractNo,
			a.contractCommenceDate,
			a.contracTerminationDate,
			a.turns,
			a.socialSecurityPermission,
			a.houseFundingPermission,
			a.bankCard,
			a.idNo
		FROM userDetail AS a
WHERE
( a.status = 0 OR a.status = 4 OR a.status = 1)
AND
 a.displayName is not null
and
(
 a.firstName != ''
OR
a.lastName != ''
)
AND
a.positionId IS NOT NULL
]]></Query>
</TableData>
<TableData name="selectUserInfo" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	a.`name`,
	a.`code`
FROM
userInfor AS a
WHERE
	a.`code` != '' AND a.`code` IS NOT NULL]]></Query>
</TableData>
<TableData name="showAttendanceUserMonth" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			SUM(a.late) AS sumLate, 
			SUM(a.leaveEarly) AS sumLeaveEarly, 
			SUM(a.attendHalf) AS sumAttendHalf, 
			SUM(a.absenteeism) AS sumAbsenteeism,
			a.late,
		 	a.leaveEarly,
			a.attendHalf, 
			a.absenteeism,  
			a.statusAttendance, 
			a.statusApprove,
			a.statusVacate, 
			a.remark, 
			a.loopYear, 
			a.typeDate,
			a.codeVacate,
			CASE WHEN
				a.typeDate = 'w'
			THEN
				'1'
			WHEN
			 	a.typeDate = 'f'
			THEN
				'0'
			END AS typeDateValue, 

			CASE WHEN
				a.statusVacate = 'v'
			THEN
				a.codeVacate
			END AS typeDateAttenVacate,  
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp,
	CASE WHEN 
		a.codeVacate = 'WO' OR a.statusAttendance = 'ap2'
	THEN
		'8.00'
	ELSE
		a.workTimeTrue
	END AS workTimeTrue,
			a.workOvertime,
			a.typeVacateDate,
a.durationAttenVacate
		FROM attendance AS a
WHERE 
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND 
	a.userId = '${userId}'
GROUP BY a.divisionName, a.date]]></Query>
</TableData>
<TableData name="showAttendanceUserDay" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cardNo"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="date"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.time,
b.displayName
FROM
zkeco_db.acc_monitor_log AS a
LEFT JOIN
`user` AS b ON b.cardNo = a.card_no
WHERE
a.card_no = '${cardNo}'
AND
DATE(a.time) = DATE('${date}')
GROUP BY a.time
ORDER BY a.time
]]></Query>
</TableData>
<TableData name="showAttendanceUserDayForSignIn.cpt" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="cardNo"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="date"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.time,
b.displayName
FROM
zkeco_db.acc_monitor_log AS a
LEFT JOIN
`user` AS b ON b.cardNo = a.card_no
WHERE
a.card_no = '${cardNo}'
AND
DATE(a.time) = DATE('${date}')]]></Query>
</TableData>
<TableData name="viewUserInfo" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
	a.`name`, a.`code`
FROM userinfor a
WHERE
	a.flag = 'i'
AND
	a.`status` = 'a']]></Query>
</TableData>
<TableData name="showOrderServiceRecord" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
(SELECT customer.`name` FROM customer WHERE customer.id = a.customer) customerName,
a.*
FROM
	orderservice AS a
WHERE
a.statusOrder = 'ap2'
AND
a.idOrderServiceRecord IS NULL
GROUP BY a.divisionId, a.customer]]></Query>
</TableData>
<TableData name="showOrderServiceRecordCheck" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderServiceRecord"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.*,
(SELECT customer.`name` FROM customer WHERE customer.id = b.customer) customerName,
b.*
FROM
orderServiceRecord a
LEFT JOIN orderservice  b ON b.idOrderServiceRecord = a.id
WHERE
b.statusOrder = 'ap2'
AND
a.id = '${idOrderServiceRecord}'
GROUP BY b.divisionId, b.customer]]></Query>
</TableData>
<TableData name="showOrderServiceTotal" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderServiceRecord"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
(SELECT division.`name` FROM division WHERE division.id = a.customer) nameCustomer,
(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.type) AS nameTypeOrderService,
(SELECT `user`.displayName FROM `user` WHERE `user`.id = a.driverId) AS nameDriver,
(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.typeExpense ) AS nameTypeExpense,
a.*
FROM
orderservice a
WHERE
a.idOrderServiceRecord = '${idOrderServiceRecord}'
ORDER BY a.divisionName, a.customer]]></Query>
</TableData>
<TableData name="showOrderServiceDetail" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
(SELECT customer.`name` FROM customer WHERE customer.id = a.customer) nameCustomer,
(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.type) AS nameTypeOrderService,
(SELECT `user`.displayName FROM `user` WHERE `user`.id = a.driverId) AS nameDriver,
(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.typeExpense ) AS nameTypeExpense,
a.*
FROM
orderservice a
WHERE
a.statusOrder IN ('ap2', 'rd')]]></Query>
</TableData>
<TableData name="showOrderServicePersional" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderService"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.*
FROM
orderService a
WHERE
a.id = '${idOrderService}']]></Query>
</TableData>
<TableData name="dicUserPermission" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="codePermission"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
			a.value1 AS divisionId,
			(SELECT division.`name` FROM division WHERE division.id = a.value1) AS divisionName
		FROM
			permission AS a
		LEFT JOIN rolePermission AS b ON (b.`code` = a.`code` AND  a.parentCode = '${codePermission}')
		LEFT JOIN userRole AS c ON c.roleId = b.roleId
		WHERE c.userId = '${userId}']]></Query>
</TableData>
<TableData name="showCountWorkExtraAttendanceMonth" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
b.hour,
TIMEDIFF(b.dayEnd, b.offHour) workDuration,
CASE WHEN
	b.dateWeek = '7' && b.dayEnd < '12:00:00' && b.statusAttendance = 'ns'
THEN
	'error'
WHEN
	b.dateWeek != '7' && (dayEnd < b.offHour || b.statusAttendance = 'ns')
THEN
 'error'

ELSE
	b.hour + cast( b.`minute`/60 as decimal(18, 2))
END AS  workDuration_a,
b.*
FROM
(

SELECT 
DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H:%i') workDuration_b,
CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd, '12:00:00'), '%H'), SIGNED) 
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H'), SIGNED)
END AS hour,
--  CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H'), SIGNED) AS hour,
CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,'12:00:00'), '%i'), SIGNED)
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%i'), SIGNED)
END AS minute,
--  CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%i'), SIGNED) AS minute,
a.*,
c.offHour,
DATE_FORMAT(a.date,'%W') week
FROM
attendance a
LEFT JOIN workextra c ON c.`name` = a.userName
WHERE
a.dateMonth = '${applyMonth}'


) AS b]]></Query>
</TableData>
<TableData name="showCountWorkExtra" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.*
FROM workextra a]]></Query>
</TableData>
<TableData name="showCountWorkExtraName" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.`name`,a.`code`
FROM
workextra a
GROUP BY
a.`name`, a.`group`]]></Query>
</TableData>
<TableData name="showCountWorkExtraDay" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
CONVERT(DATE_FORMAT(a.date,'%d'), SIGNED) dayFull,
DAYOFWEEK(a.date) dayOfWeek,
DATE_FORMAT(a.date,'%W') week,
a.date,
a.*
FROM
attendance a
WHERE
a.dateMonth = '${applyMonth}'
GROUP BY a.date


]]></Query>
</TableData>
<TableData name="showAttendanceUserDayForWorkExtra" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userName"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="date"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.time,
b.displayName
FROM
zkeco_db.acc_monitor_log AS a
LEFT JOIN
`user` AS b ON b.cardNo = a.card_no
WHERE
b.displayName = '${userName}'
AND
DATE(a.time) = DATE('${date}')
GROUP BY a.time
ORDER BY a.time
]]></Query>
</TableData>
<TableData name="showCountWorkExtraWorkFullHour" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userName,
COUNT(a.statusAttendance)
FROM attendance a
WHERE a.dateMonth = '${applyMonth}'
AND
a.statusAttendance IN ('ns', 're1', 're2')
GROUP BY a.userName]]></Query>
</TableData>
<TableData name="showCountWorkExtraGroup" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.*
FROM workextra a]]></Query>
</TableData>
<TableData name="showCountWorkExtraGroupUser" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.`name`,a.`group`
FROM
workextra a
GROUP BY a.`name`]]></Query>
</TableData>
<TableData name="showCountWorkExtraAttendanceMonthV2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
CASE WHEN
	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
THEN
 'error'
ELSE
	b.hour_a + cast( b.minute_a/60 as decimal(18, 2))
END AS  workDuration_a,
-- 
-- CASE WHEN
-- 	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
-- THEN
--  'error'
-- ELSE
-- ((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16)
-- END AS  workDuration_floor_a,


CASE WHEN
	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
THEN
 'error'
WHEN 
	((((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5) >= 1
THEN
(((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5
ELSE
0
END AS  workDuration_div_a,


CASE WHEN
	b.dateWeek = '7' && b.dayEnd < '12:00:00' && b.statusAttendance = 'ns'
THEN
	'error'
WHEN
	b.dateWeek != '7' && (dayEnd < b.offHour || b.statusAttendance = 'ns')
THEN
 'error'
ELSE
	b.hour_b + cast( b.minute_b/60 as decimal(18, 2))
END AS  workDuration_b,

CASE WHEN
	b.dateWeek = '7' && b.dayEnd < '12:00:00' && b.statusAttendance = 'ns'
THEN
	'error'
WHEN
	b.dateWeek != '7' && (dayEnd < b.offHour || b.statusAttendance = 'ns')
THEN
 'error'
WHEN
	((((b.hour_b + cast( b.minute_b/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5) >= 1
THEN
	(((b.hour_b + cast( b.minute_b/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5
ELSE
	0
END AS  workDuration_div_b,


b.*
FROM
(

SELECT 
DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%H:%i') workDuration_a,
DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H:%i') workDuration_b,


CASE
WHEN
	a.dayStart < c.workingHour && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%H'), SIGNED)
END AS hour_a,

CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd, '12:00:00'), '%H'), SIGNED) 
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H'), SIGNED)
END AS hour_b,

CASE
WHEN
	a.dayStart < c.workingHour && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%i'), SIGNED)
END AS minute_a,

CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,'12:00:00'), '%i'), SIGNED)
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%i'), SIGNED)
END AS minute_b,

a.*,
c.offHour,
c.workingHour,
DATE_FORMAT(a.date,'%W') week
FROM
attendance a
LEFT JOIN workextra c ON c.`name` = a.userName
WHERE

a.dateMonth = '${applyMonth}'


) AS b
]]></Query>
</TableData>
<TableData name="showRegistList" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.signinLocation) signinLocationShow,
	(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.signinDate) signinDateShow,
	a.*

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusVacate = 'a'
AND
	a.typeDate = 'w'
AND 
	a.statusAttendance != 'no'
ORDER BY a.divisionId, a.userName, a.date]]></Query>
</TableData>
<TableData name="showRegistListName" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	a.userId,
	a.userName,
	a.divisionName
FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusVacate = 'a'
AND
	a.typeDate = 'w'
GROUP BY a.userId]]></Query>
</TableData>
<TableData name="showRegistListStatusNs" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 'ns']]></Query>
</TableData>
<TableData name="showRegistListStatusRe" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 're']]></Query>
</TableData>
<TableData name="showRegistListStatusAp1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 'ap1']]></Query>
</TableData>
<TableData name="showRegistListStatusAp2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 'ap2']]></Query>
</TableData>
<TableData name="showRegistListStatusRe1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 're1']]></Query>
</TableData>
<TableData name="showRegistListStatusRe2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.userId,
COUNT(a.statusAttendance) statusCount

FROM
	attendance a
WHERE
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.statusAttendance = 're2']]></Query>
</TableData>
<TableData name="attRecWorkExtraAve" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 

-- 			CASE WHEN
-- 				a.dateWeek = '7'
-- 			THEN
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
-- 			ELSE
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
-- 			END workDuration,

			(HOUR(a.timeWork) + MINUTE(a.timeWork)/60 -
				(CASE WHEN
					a.dateWeek = '7'
				THEN
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
				ELSE
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
				END)) trueWrokDuration,

			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			a.late, 
			a.leaveEarly, 
			a.attendHalf, 
			a.absenteeism, 
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp
		FROM attendance AS a
LEFT JOIN permission b ON ( b.parentCode = '1615000' AND b.value1 = a.divisionId)
LEFT JOIN attenrule c ON (c.id = b.value2)
WHERE 
	a.statusVacate = 'a'
ORDER BY a.divisionName, a.userId
]]></Query>
</TableData>
<TableData name="attRecWorkExtraGroup2" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT 
	a.dateMonth,
	a.date,
	a.divisionName,
	a.divisionId,
	COUNT(DISTINCT a.userId) countUser,
	SUM(a.workOvertime) AS sumWorkOvertime,
	SUM(a.typeDate = 'w') AS sumWorkDay	
FROM attendance AS a 
GROUP BY a.dateMonth, a.divisionName
ORDER BY a.dateMonth, a.divisionName ]]></Query>
</TableData>
<TableData name="attRecWorkExtraGroup" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT 
	a.dateMonth,
	a.date,
	a.divisionName,
	a.divisionId,
	COUNT(DISTINCT a.userId) countUser

FROM attendance AS a
where a.statusAttendance = 'no'
GROUP BY a.dateMonth, a.divisionName
ORDER BY a.dateMonth, a.divisionName ]]></Query>
</TableData>
<TableData name="showCountWorkExtraAttendanceMonthV3" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
CASE WHEN
	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
THEN
 'error'
ELSE
	b.hour_a + cast( b.minute_a/60 as decimal(18, 2))
END AS  workDuration_a,
-- 
-- CASE WHEN
-- 	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
-- THEN
--  'error'
-- ELSE
-- ((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16)
-- END AS  workDuration_floor_a,


CASE WHEN
	b.dayStart > b.workingHour || b.statusAttendance = 'ns'
THEN
 'error'
WHEN 
	((((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5) >= 1
THEN
(((b.hour_a + cast( b.minute_a/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5
ELSE
0
END AS  workDuration_div_a,


CASE WHEN
	b.dateWeek = '7' && b.dayEnd < '12:00:00' && b.statusAttendance = 'ns'
THEN
	'error'
WHEN
	b.dateWeek != '7' && (dayEnd < b.offHour || b.statusAttendance = 'ns')
THEN
 'error'
ELSE
	b.hour_b + cast( b.minute_b/60 as decimal(18, 2))
END AS  workDuration_b,

CASE WHEN
	b.dateWeek = '7' && b.dayEnd < '12:00:00' && b.statusAttendance = 'ns'
THEN
	'error'
WHEN
	b.dateWeek != '7' && (dayEnd < b.offHour || b.statusAttendance = 'ns')
THEN
 'error'
WHEN
	((((b.hour_b + cast( b.minute_b/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5) >= 1
THEN
	(((b.hour_b + cast( b.minute_b/60 as decimal(18, 2))) + 0.16) DIV 0.5) * 0.5
ELSE
	0
END AS  workDuration_div_b,


b.*
FROM
(

SELECT 
DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%H:%i') workDuration_a,
DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H:%i') workDuration_b,


CASE
WHEN
	a.dayStart < c.workingHour && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%H'), SIGNED)
END AS hour_a,

CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd, '12:00:00'), '%H'), SIGNED) 
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%H'), SIGNED)
END AS hour_b,

CASE
WHEN
	a.dayStart < c.workingHour && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(c.workingHour, a.dayStart), '%i'), SIGNED)
END AS minute_a,

CASE
WHEN
	a.dateWeek = '7' && a.dayEnd > '12:00:00' && a.statusAttendance != 'ns'
THEN
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,'12:00:00'), '%i'), SIGNED)
ELSE
	CONVERT(DATE_FORMAT(TIMEDIFF(a.dayEnd,c.offHour), '%i'), SIGNED)
END AS minute_b,

a.*,
c.offHour,
c.workingHour,
DATE_FORMAT(a.date,'%W') week
FROM
attendance a
LEFT JOIN workextra c ON c.`name` = a.userName
WHERE

a.dateMonth = '${applyMonth}'


) AS b
]]></Query>
</TableData>
<TableData name="selectUserInfor" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT *
FROM userinfor]]></Query>
</TableData>
<TableData name="showAttendanceUserYear" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 

			a.dayStart, 
			a.dayEnd, 
			SUM(a.late) AS sumLate, 
			SUM(a.leaveEarly) AS sumLeaveEarly, 
			SUM(a.attendHalf) AS sumAttendHalf, 
			SUM(a.absenteeism) AS sumAbsenteeism,
		a.cardNo,
 
			a.date,  
			CASE WHEN
				a.statusAttendance = 'no'
			THEN
				'正常'
			WHEN
					a.statusAttendance = 'ns'
			THEN
				'未补签'
			WHEN
					a.statusAttendance = 're'
			THEN
				'已补签'
			WHEN
					a.statusAttendance = 'ap1'
			THEN
				'经理审批'
			WHEN
					a.statusAttendance = 'ap2'
			THEN
				'行政审批'
			WHEN
					a.statusAttendance = 're1'
			THEN
				'部门驳回'
			WHEN
					a.statusAttendance = 're2'
			THEN
				'行政驳回'
			END statusAttendance,

			a.statusVacate, 
			(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.signinLocation) signinLocation,
			(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.signinDate) signinDate,
			a.remark,
CASE WHEN
				a.typeDate = 'w'
			THEN
				'1'
			WHEN
			 	a.typeDate = 'f'
			THEN
				'0'
			END AS typeDateValue
		FROM attendance AS a
WHERE 
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
GROUP BY a.divisionName, a.userName, a.date
order by a.divisionName, a.userName, a.date]]></Query>
</TableData>
<TableData name="searchOrderServiceReimbursement" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="pid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	a.*,
	b.name  currencyName
FROM
ordercategoryservice a
LEFT JOIN userinfor b on b.code = a.currencyCode
WHERE
a.id = ${pid}]]></Query>
</TableData>
<TableData name="searchOrderServiceReimbursementDetail" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="pid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.*
FROM
ordercategoryservicedetail a
WHERE
a.idOrderCategoryService = ${pid}]]></Query>
</TableData>
<TableData name="showAttendanceYear" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="divisionId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 

-- 			CASE WHEN
-- 				a.dateWeek = '7'
-- 			THEN
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
-- 			ELSE
-- 				(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
-- 			END workDuration,

			(HOUR(a.timeWork) + MINUTE(a.timeWork)/60 -
				(CASE WHEN
					a.dateWeek = '7'
				THEN
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time7)
				ELSE
					(SELECT attenday.workDuration FROM attenday WHERE attenday.id = c.time2)
				END)) trueWrokDuration,

			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			a.late, 
			a.leaveEarly, 
			a.attendHalf, 
			a.absenteeism, 
			a.statusAttendance, 
			a.statusApprove, 
			a.remark, 
			a.loopYear, 
			a.typeDate, 
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp,
			a.workTimeTrue,
			a.workOvertime,
			a.typeVacateDate,
			a.durationAttenVacate,
			a.typeDate,
			a.statusVacate,
			a.codeVacate
		FROM attendance AS a
LEFT JOIN permission b ON ( b.parentCode = '1615000' AND b.value1 = a.divisionId)
LEFT JOIN attenrule c ON (c.id = b.value2)
WHERE 
    a.date >= '${startDate}'
AND
    a.date <= '${endDate}'
 AND 
    a.divisionId = '${divisionId}'
ORDER BY a.divisionName, a.userId, a.date

]]></Query>
</TableData>
<TableData name="dropListDivisionLevel3" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
d.id, d.`name`
FROM division d
WHERE
d.tag = 'd'
AND
d.`status` = '0'
AND
d.`level` = 3
ORDER BY d.`name`]]></Query>
</TableData>
<TableData name="showAttenVacateApproveYear" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="divisionId"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT 
	a.id, 
	a.name, 
	a.divisionId, 
	a.divisionName, 
	a.userId, 
	a.userName, 
	a.idVacate, 
	a.nameVacate, 
	a.dateStart, 
	a.dateEnd, 
	a.hourStart, 
	a.hourEnd, 
	a.minuteStart, 
	a.minuteEnd, 
	a.typeVacateDate, 
	a.reason, 
	a.duration, 
	a.workday, 
	a.approveId, 
	a.approveName, 
	a.approveDate, 
	a.approveStatus, 
	a.approveId1, 
	a.approveName1, 
	a.approveDate1, 
	a.approveId2, 
	a.approveName2, 
	a.approveDate2, 
	a.remark, 
	a.tag, 
	a.addDate, 
	a.addUser, 
	a.addIp, 
	a.modifiedDate, 
	a.modifiedUser, 
	a.modifiedIp,
	a.cardNo,
	date_format(a.addDate,'%Y-%m-%d') vacateAddDate
FROM attenVacateManage AS a
WHERE
	a.typeData = 'v'
AND
	((
	a.dateStart >= '${startDate}'
	AND
	a.dateStart <= '${endDate}')
	OR
	(a.dateEnd >= '${startDate}'
	AND
	a.dateEnd <= '${endDate}')
	)
AND
	(
	approveStatus = 'ap1'
	OR
	approveStatus = 'ap2'
	OR
	approveStatus = 'ap3'
	)
 AND 
    a.divisionId = '${divisionId}'
ORDER BY a.divisionId,a.userName,a.dateStart
]]></Query>
</TableData>
<TableData name="showUserInfor" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
(SELECT name FROM division WHERE division.id = a.departmentId) divisionName,
a.*
FROM
userdetail a
where
a.userId = '${userId}'
]]></Query>
</TableData>
<TableData name="searchOrderServiceReimbursApprover1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="pid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
DISTINCT a.approverName1
FROM
ordercategoryservicedetail a
WHERE
LENGTH(approverName1) > 0
AND
a.idOrderCategoryService = '${pid}']]></Query>
</TableData>
<TableData name="searchOrderServiceReimbursApprover2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="pid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
DISTINCT a.approverName2
FROM
ordercategoryservicedetail a
WHERE
LENGTH(approverName2) > 0
AND
a.idOrderCategoryService = '${pid}']]></Query>
</TableData>
<TableData name="searchOrderServiceReimbursApprover3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="pid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
DISTINCT a.approverName3
FROM
ordercategoryservicedetail a
WHERE
LENGTH(approverName3) > 0
AND
a.idOrderCategoryService = '${pid}']]></Query>
</TableData>
<TableData name="showOrderCategoryAll" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
b.id,
b.idOrderCategoryService,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
a.`status`,
a.countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.countApprovePercent = 100
ORDER BY a.applicantDivisionId, a.applicantId, a.id
]]></Query>
</TableData>
<TableData name="showOrderCategory" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[-- showOrderCategory.cpt

SELECT
b.id,
b.idOrderCategoryService,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
b.idCategoryLeve1,
b.idCategoryLevel2,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
a.`status`,
a.countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.countApprovePercent = 100
AND
a.`status` != 're'
ORDER BY b.idCategoryLeve1, b.idCategoryLevel2, a.applicantDivisionId, a.applicantId, a.id, b.customerId1


]]></Query>
</TableData>
<TableData name="showOrderServiceDetailGroup" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
(SELECT division.`name` FROM division WHERE division.id = a.customer) nameCustomer,
-- (SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.type) AS nameTypeOrderService,
(SELECT `user`.displayName FROM `user` WHERE `user`.id = a.driverId) AS nameDriver,
(SELECT userinfor.`name` FROM userinfor WHERE userinfor.`code` = a.typeExpense ) AS nameTypeExpense,
(SELECT
(SELECT permission.`name` FROM permission WHERE permission.`parentCode` = '7102000' AND permission.`code` = rp.code)
FROM 
	rolepermission rp
WHERE rp.parentCode = '7102000' AND rp.typeId = a.divisionId LIMIT 1) nameGroup,
a.*
FROM
orderservice a
WHERE
a.driverId IS NOT NULL
ORDER BY driverId, divisionId;]]></Query>
</TableData>
<TableData name="showOrderServiceDriverGRoup" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
p.code,
p.`name`
FROM
permission p
WHERE
p.parentCode = '7102000';]]></Query>
</TableData>
<TableData name="EmployEntryAndExit" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
u.entryDate,
u.displayName,
u.gender,
(SELECT division.`name` FROM division WHERE division.id = u.departmentId) divisionName,
u.socialSecurityPermission,
u.houseFundinRange,
u.contractNo,
u.contractCommenceDate,
u.contractor,
u.socialSecurityCommenceDate,
u.houseFundingCommenceDate,
u.status,
u.socialSecurityRange,
u.houseFundinRange,
u.departedDate,
u.positiveDate,
u.remarkEntry

FROM
userdetail u

ORDER BY u.entryDate DESC;]]></Query>
</TableData>
<TableData name="EmployWelfare" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
u.displayName,
u.departmentId,
u.positionId,
u.contractor,
u.socialSecurityCommenceDate,
u.socialSecurityTerminationDate,
u.houseFundingCommenceDate,
u.houseFundingTerminationDate,
u.heating,
u.contractNo,
u.contractCommenceDate,
u.contracTerminationDate,
u.resgisteredResidence,
u.idNo,
u.phoneNo,
u.status,
u.entryDate,
u.departedDate,
u.positiveDate,
(SELECT division.`name` FROM division WHERE division.id = u.departmentId) divisionName,
u.email

FROM userdetail u]]></Query>
</TableData>
<TableData name="showCountWorkExtraV4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	u.userId,
	u.displayName,
	u.idNo,
	u.bankCard,
	(a.workOvertimeBefore DIV 0.5)*0.5 workOvertimeBeforeCount,
	(a.workOvertimeAfter DIV 0.5)*0.5 workOvertimeAfterCount,
	(a.workOvertime DIV 0.5)*0.5 workOvertimeCount,
	CASE WHEN 
		a.typeDate = 'f'
	THEN
		(a.workOvertime DIV 0.5)*0.5 
	ELSE
		0
	END
	AS workOvertimeCountFestival,
	DATE_FORMAT(a.date,'%W') week,
	a.*,
	(SELECT division.`name` FROM division WHERE division.id = dr.divisionId) workGroupName,
	dr.divisionId workGroupId 
FROM userdetail u
LEFT JOIN attendance a ON a.userId = u.userId
LEFT JOIN divisionrole dr ON dr.divisionId = u.departmentId
LEFT JOIN rolepermission rp ON rp.roleId = dr.roleId
WHERE
	rp.`code` = '7103001'
AND 
	dr.divisionId IS NOT NULL
AND
u.extraWorkPay = 'y'
AND
-- a.dateMonth = '${applyMonth}'
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
GROUP BY workGroupName,u.displayName,a.date
ORDER BY workGroupName,u.displayName,a.date]]></Query>
</TableData>
<TableData name="showCountWorkExtraDivision" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
	(SELECT division.`name` FROM division WHERE division.id = dr.divisionId) divisionName,
	dr.divisionId 
FROM divisionrole dr
LEFT JOIN rolepermission rp ON rp.roleId = dr.roleId
WHERE
	rp.`code` = '7103001'
AND dr.divisionId IS NOT NULL]]></Query>
</TableData>
<TableData name="showAttenUserByDate" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			SUM(a.late) AS sumLate, 
			SUM(a.leaveEarly) AS sumLeaveEarly, 
			SUM(a.attendHalf) AS sumAttendHalf, 
			SUM(a.absenteeism) AS sumAbsenteeism,
			a.late,
		 	a.leaveEarly,
			a.attendHalf, 
			a.absenteeism,  
			a.statusAttendance, 
			a.statusApprove,
			a.statusVacate, 
			a.remark, 
			a.loopYear, 
			a.typeDate,
			a.codeVacate,
			CASE WHEN
				a.typeDate = 'w'
			THEN
				'1'
			WHEN
			 	a.typeDate = 'f'
			THEN
				'0'
			END AS typeDateValue, 

			CASE WHEN
				a.statusVacate = 'v'
			THEN
				a.codeVacate
			END AS typeDateAttenVacate,  
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp,
			a.workTimeTrue,
			a.workOvertime,
			a.typeVacateDate,
a.durationAttenVacate
		FROM attendance AS a
GROUP BY a.divisionName, a.userId, a.date]]></Query>
</TableData>
<TableData name="showOrderCategoryAllCurrnet" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
DATE_FORMAT(a.applicantDate,'%Y-%m-%d') applicantDateFormat,
b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approverName4,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
b.approveStatus4,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status != 'd'
AND
a.status != 'rd'
AND
a.typeData = 'r'
ORDER BY  a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryByApprover" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderServiceRecord"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT

b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
a.typeInvoiceCode,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status = 'c'
AND
b.approverName1 IS NOT NULL
AND
a.idOrderServiceRecord = '${idOrderServiceRecord}'
AND
a.approverId = '${userId}'
ORDER BY  b.approverName1,a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryByApproverAll" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT

b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
a.idOrderServiceRecord,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status = 'af'
AND
a.approverId = '${userId}'
ORDER BY  a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryByApprover2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderServiceRecord"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
CASE WHEN
	b.approverName2 != ''
THEN
	b.approverName2
ELSE
	b.approverName1
END approverNameLv2,
b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
a.typeInvoiceCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status = 'c'
AND
b.approverName1 IS NOT NULL
AND
a.idOrderServiceRecord = '${idOrderServiceRecord}'
AND
a.approverId = '${userId}'
AND
(b.approverId1   IN (

SELECT DISTINCT c.approverId2 FROM ordercategoryservicedetail c
WHERE 
c.approverId2 IS NOT NULL 
AND
c.approverId2 != ''
) OR

b.approverId2   IN (

SELECT DISTINCT c.approverId2 FROM ordercategoryservicedetail c
WHERE 
c.approverId2 IS NOT NULL 
AND
c.approverId2 != ''
)
)



ORDER BY  a.applicantDivisionId, approverNameLv2,a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryByApprover1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="idOrderServiceRecord"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT

b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
a.typeInvoiceCode,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status = 'c'
AND
b.approverName1 IS NOT NULL
AND
a.idOrderServiceRecord = '${idOrderServiceRecord}'
AND
a.approverId = '${userId}'
AND
b.approverId1 NOT  IN (

SELECT DISTINCT c.approverId2 FROM ordercategoryservicedetail c
WHERE 
c.approverId2 IS NOT NULL 
AND
c.approverId2 != ''
)
ORDER BY  b.approverName1,a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategorAprove" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="status"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="userId"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT

b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.applicantName,
a.payeeName,
a.applicantDate,
a.idOrderServiceRecord,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
WHERE
a.status = '${status}'
AND
a.approverId = '${userId}'
ORDER BY  a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryMonth" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.id,
b.idOrderCategoryService,
b.id idOrderCategoryServiceDetail,
a.applicantDivisionId,
a.applicantDivisionName,
a.month,
a.typeInvoiceName,
a.typeInvoiceCode,
a.typePaymentCode,
a.typePaymentName,
a.applicantName,
a.payeeName,
-- 查询收款人姓名
CASE WHEN 
	a.payeeId IS NOT NULL && LENGTH(a.payeeId) = 36
THEN
	(SELECT ud.displayName FROM userdetail ud WHERE ud.userId = a.payeeId)
ELSE
	a.payeeName
END payeeNameZh,
a.applicantDate,
a.bankName,
a.bankCard,
b.nameCategoryLevel1,
b.nameCategoryLevel2,
c.financeCategory,
c.financeNo,
b.customerName1,
a.currencyCode,
b.amount,
b.amountRmb,
b.remark,
b.approverName1,
b.approverName2,
b.approverName3,
b.approverName4,
b.approveStatus1,
b.approveStatus2,
b.approveStatus3,
b.approveStatus4,
b.divisionName,
CASE WHEN 
b.countApprovePercent IS NULL
THEN '0%'
ELSE
	CONCAT(b.countApprovePercent, '%')
END countApprovePercentDetail,
a.totalAmountRmb,
a.totalAmount,
a.`status`,
CASE WHEN
	a.`status` = 'd'
THEN
	'草稿'
WHEN
	a.`status` = 's'
THEN
	'已提交'
WHEN
	a.`status` = 're'
THEN
	'驳回'
WHEN
	a.`status` = 'ap'
THEN
	'审批中'
END status2,
CASE WHEN 
a.countApprovePercent IS NULL
THEN '0%'
ELSE
 CONCAT(a.countApprovePercent, '%')	
END countApprovePercent,
a.approveDate
FROM
ordercategoryservice a
LEFT JOIN ordercategoryservicedetail b ON b.idOrderCategoryService = a.id
LEFT JOIN ordercategory c ON c.id = b.idCategoryLevel2
where
a.status = 'c'
ORDER BY  a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryList" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 

* 
FROM ordercategory o
WHERE o.tag = 'a'
AND o.typeData = 'r'
AND o.`level` = 2



]]></Query>
</TableData>
<TableData name="showOrderCategoryTotal" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
a.id,
-- 查询收款人姓名
CASE WHEN 
	a.payeeId IS NOT NULL && LENGTH(a.payeeId) = 36
THEN
	(SELECT ud.displayName FROM userdetail ud WHERE ud.userId = a.payeeId)
ELSE
	a.payeeName
END payeeNameZh,
a.applicantDivisionId,
a.applicantDivisionName,
a.month,
a.typeInvoiceName,
a.typeInvoiceCode,
a.typePaymentCode,
a.typePaymentName,
a.applicantName,
a.payeeName,
a.applicantDate,
a.bankName,
a.bankCard,
a.currencyCode,
a.totalAmountRmb,
a.approveDate,
a.totalAmount
FROM
ordercategoryservice a
WHERE

a.status = 'c'
ORDER BY  a.id DESC
]]></Query>
</TableData>
<TableData name="showOrderCategoryServiceModify" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT 
	h.*
FROM 
	syshistory h
WHERE
	h.type = 'mosa'
ORDER BY h.logDate DESC]]></Query>
</TableData>
<TableData name="attRecWorkExtraGroup3" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[	SELECT 
			a.id, 
			a.userId, 
			a.userName, 
			a.divisionId, 
			a.divisionName, 
			a.cardNo, 
			a.timeStart, 
			a.timeEnd, 
			a.dayStart, 
			a.dayEnd, 
			a.day, 
			a.dateMonth, 
			a.dateWeek, 
			a.date, 
			a.dateAddMonth, 
			a.timeWork, 
			SUM(a.late) AS sumLate, 
			SUM(a.leaveEarly) AS sumLeaveEarly, 
			SUM(a.attendHalf) AS sumAttendHalf, 
			SUM(a.absenteeism) AS sumAbsenteeism,
			a.late,
		 	a.leaveEarly,
			a.attendHalf, 
			a.absenteeism,  
			a.statusAttendance, 
			a.statusApprove,
			a.statusVacate, 
			a.remark, 
			a.loopYear, 
			a.typeDate,
			a.codeVacate,
			CASE WHEN
				a.typeDate = 'w'
			THEN
				'1'
			WHEN
			 	a.typeDate = 'f'
			THEN
				'0'
			END AS typeDateValue, 

			CASE WHEN
				a.statusVacate = 'v'
			THEN
				a.codeVacate
			END AS typeDateAttenVacate,  
			a.festivelName, 
			a.addDate, 
			a.addUser, 
			a.addIp, 
			a.modifiedDate, 
			a.modifiedUser, 
			a.modifiedIp,
	CASE WHEN 
		a.codeVacate = 'WO' OR a.statusAttendance = 'ap2'
	THEN
		'8.00'
	ELSE
		a.workTimeTrue
	END AS workTimeTrue,
			a.workOvertime,
			a.typeVacateDate,
a.durationAttenVacate
		FROM attendance AS a
GROUP BY a.divisionName, a.date
ORDER BY a.dateMonth, a.divisionName ]]></Query>
</TableData>
<TableData name="showCountWorkExtraV5" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="applyMonth"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateEnd"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="attenCollectDateStart"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[FRDemo]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT
	u.userId,
	u.displayName,
	u.idNo,
	u.bankCard,
	(a.workOvertimeBeforeApprove DIV 0.5)*0.5 workOvertimeBeforeCount,
	(a.workOvertimeAfterApprove DIV 0.5)*0.5 workOvertimeAfterCount,
	(a.workOvertimeApprove DIV 0.5)*0.5 workOvertimeCount,
	CASE WHEN 
		a.typeDate = 'f'
	THEN
		(a.workOvertimeApprove DIV 0.5)*0.5 
	ELSE
		0
	END
	AS workOvertimeCountFestival,
	CASE WHEN 
		a.codeVacate = 'PL'
	THEN
		a.durationAttenVacateHour
	ELSE
		0
	END
	AS attenVacatePL,
	DATE_FORMAT(a.date,'%W') week,
	a.*,
	(SELECT division.`name` FROM division WHERE division.id = dr.divisionId) workGroupName,
	dr.divisionId workGroupId 
FROM userdetail u
LEFT JOIN attendance a ON a.userId = u.userId
LEFT JOIN divisionrole dr ON dr.divisionId = u.departmentId
LEFT JOIN rolepermission rp ON rp.roleId = dr.roleId
WHERE
--	rp.`code` = '7103001'
-- AND 
	dr.divisionId IS NOT NULL

AND
-- a.dateMonth = '${applyMonth}'
	a.date >= '${attenCollectDateStart}'
AND
	a.date <= '${attenCollectDateEnd}'
AND
	a.tagOvertime = 'y'
GROUP BY workGroupName,u.displayName,a.date
ORDER BY workGroupName,u.displayName,a.date]]></Query>
</TableData>
</TableDataMap>
</DatasourceManager>
